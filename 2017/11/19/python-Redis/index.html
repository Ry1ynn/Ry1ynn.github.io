<!DOCTYPE html>



  



<html class="theme-next pisces use-motion" lang="zh-Hans">
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/favicon.ico?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon.ico?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon.ico?v=5.1.4">






  <meta name="keywords" content="python,redis,">










<meta name="description" content="Redis相关00-简介 NoSQL简介  NoSQL，全名为Not Only SQL，指的是非关系型的数据库 随着访问量的上升，网站的数据库性能出现了问题，于是nosql被设计出来   优点/缺点  优点: 高可扩展性 分布式计算">
<meta name="keywords" content="python,redis">
<meta property="og:type" content="article">
<meta property="og:title" content="python-Redis">
<meta property="og:url" content="http://21guns.top/2017/11/19/python-Redis/index.html">
<meta property="og:site_name" content="Ry1ynn&#39;s blogs">
<meta property="og:description" content="Redis相关00-简介 NoSQL简介  NoSQL，全名为Not Only SQL，指的是非关系型的数据库 随着访问量的上升，网站的数据库性能出现了问题，于是nosql被设计出来   优点/缺点  优点: 高可扩展性 分布式计算">
<meta property="og:locale" content="zh-Hans">
<meta property="og:updated_time" content="2019-02-18T09:27:15.548Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="python-Redis">
<meta name="twitter:description" content="Redis相关00-简介 NoSQL简介  NoSQL，全名为Not Only SQL，指的是非关系型的数据库 随着访问量的上升，网站的数据库性能出现了问题，于是nosql被设计出来   优点/缺点  优点: 高可扩展性 分布式计算">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://21guns.top/2017/11/19/python-Redis/">





  <title>python-Redis | Ry1ynn's blogs</title>
  










</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Ry1ynn's blogs</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br>
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br>
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            归档
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://21guns.top/2017/11/19/python-Redis/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Ry1ynn">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Ry1ynn's blogs">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">python-Redis</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-11-19T17:24:08+08:00">
                2017-11-19
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/python/" itemprop="url" rel="index">
                    <span itemprop="name">python</span>
                  </a>
                </span>

                
                
                  ， 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/python/数据库相关/" itemprop="url" rel="index">
                    <span itemprop="name">数据库相关</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <h1 id="Redis相关"><a href="#Redis相关" class="headerlink" title="Redis相关"></a>Redis相关</h1><h2 id="00-简介"><a href="#00-简介" class="headerlink" title="00-简介"></a>00-简介</h2><ul>
<li><p>NoSQL简介</p>
<ul>
<li>NoSQL，全名为Not Only SQL，指的是非关系型的数据库</li>
<li>随着访问量的上升，网站的数据库性能出现了问题，于是nosql被设计出来</li>
</ul>
</li>
<li><p>优点/缺点</p>
<ul>
<li>优点:<ul>
<li>高可扩展性</li>
<li>分布式计算<a id="more"></a></li>
<li>低成本</li>
<li>架构的灵活性，半结构化数据</li>
<li>没有复杂的关系</li>
</ul>
</li>
<li>缺点:<ul>
<li>没有标准化</li>
<li>有限的查询功能（到目前为止）</li>
<li>最终一致是不直观的程序</li>
</ul>
</li>
</ul>
</li>
<li><p>分类</p>
<p>| 类型          | 部分代表                                         | 特点                                                         |<br>| ————- | ———————————————— | ———————————————————— |<br>| 列存储        | HbaseCassandraHypertable                         | 顾名思义，是按列存储数据的。最大的特点是方便存储结构化和半结构化数据，方便做数据压缩，对针对某一列或者某几列的查询有非常大的IO优势。 |<br>| 文档存储      | MongoDBCouchDB                                   | 文档存储一般用类似json的格式存储，存储的内容是文档型的。这样也就有有机会对某些字段建立索引，实现关系数据库的某些功能。 |<br>| key-value存储 | Tokyo Cabinet / TyrantBerkeley DBMemcacheDBRedis | 可以通过key快速查询到其value。一般来说，存储不管value的格式，照单全收。（Redis包含了其他功能） |<br>| 图存储        | Neo4JFlockDB                                     | 图形关系的最佳存储。使用传统关系数据库来解决的话性能低下，而且设计使用不方便。 |<br>| 对象存储      | db4oVersant                                      | 通过类似面向对象语言的语法操作数据库，通过对象的方式存取数据。 |<br>| xml数据库     | Berkeley DB XMLBaseX                             | 高效的存储XML数据，并支持XML的内部查询语法，比如XQuery,Xpath。 |</p>
</li>
</ul>
<h2 id="01-安装"><a href="#01-安装" class="headerlink" title="01-安装"></a>01-安装</h2><ul>
<li><p>安装</p>
<ul>
<li><p>下载：打开<a href="https://redis.io/" target="_blank" rel="noopener">redis官方网站</a>，推荐下载稳定版本(stable)</p>
</li>
<li><p>解压 <code>tar zxvf redis-3.2.5.tar.gz</code></p>
</li>
<li><p>复制：推荐放到usr/local目录下</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo mv -r redis-3.2.3/* /usr/local/redis/</span><br><span class="line">进入redis目录</span><br><span class="line">cd /usr/local/redis/</span><br></pre></td></tr></table></figure>
</li>
<li><p>生成 <code>sudo make</code></p>
</li>
<li><p>测试</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo make test</span><br><span class="line">这段运行时间会较长</span><br></pre></td></tr></table></figure>
</li>
<li><p>安装：将redis的命令安装到/usr/bin/目录 <code>sudo make install</code></p>
</li>
</ul>
</li>
<li><p>运行</p>
<ul>
<li><p>启动服务器：在桌面目录</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">redis-server</span><br><span class="line">按ctrl+c停止</span><br></pre></td></tr></table></figure>
</li>
<li><p>启动客户端：在新终端中运行如下代码 <code>redis-cli</code></p>
</li>
<li><p>运行命令</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ping</span><br><span class="line">set &apos;a&apos; &apos;123&apos;</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>当添加键值后，发现在当前运行的目录下，创建了一个文件：dump.rdb，这个文件用于将数据持久化存储</p>
</li>
</ul>
<h2 id="02-配置"><a href="#02-配置" class="headerlink" title="02-配置"></a>02-配置</h2><ul>
<li><p>基本配置</p>
<ul>
<li><p>在源文件/usr/local/redis目录下，文件redis.conf为配置文件</p>
</li>
<li><p>绑定地址：如果需要远程访问，可将此行注释</p>
<p><code>bind 127.0.0.1</code></p>
</li>
<li><p>端口，默认为6379</p>
<p><code>port 6379</code></p>
</li>
<li><p>是否以守护进程运行</p>
<ul>
<li>如果以守护进程运行，则不会在命令行阻塞，类似于服务</li>
<li>如果以非守护进程运行，则当前终端被阻塞，无法使用</li>
<li>推荐改为yes，以守护进程运行</li>
</ul>
<p><code>daemonize no|yes</code></p>
</li>
<li><p>数据文件 <code>dbfilename dump.rdb</code></p>
</li>
<li><p>数据文件存储路径</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">dir的默认值为./，表示当前目录</span><br><span class="line">推荐改为：dir /var/lib/redis</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>使用配置文件方式启动</p>
<ul>
<li><p>直接运行redis-server会直接运行，阻塞当前终端</p>
</li>
<li><p>一般配置文件都放在/etc/目录下</p>
<p><code>sudo cp /usr/local/redis/redis.conf /etc/redis/</code></p>
</li>
<li><p>推荐指定配置文件启动 <code>sudo redis-server /etc/redis/redis.conf</code></p>
</li>
<li><p>停止redis服务</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ps ajx|grep redis</span><br><span class="line">sudo kill -9 redis的进程id</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
<h2 id="03-数据操作"><a href="#03-数据操作" class="headerlink" title="03-数据操作"></a>03-数据操作</h2><ul>
<li>redis是key-value的数据，所以每个数据都是一个键值对</li>
<li>键的类型是字符串</li>
<li>值的类型分为五种：<ul>
<li>字符串string</li>
<li>哈希hash</li>
<li>列表list</li>
<li>集合set</li>
<li>有序集合zset</li>
</ul>
</li>
<li>数据操作的全部命令，可以查看<a href="http://redis.cn/commands.html" target="_blank" rel="noopener">中文网站</a></li>
<li>接下来逐个介绍操作各类型的命令</li>
</ul>
<h3 id="3-1-string"><a href="#3-1-string" class="headerlink" title="3.1-string"></a>3.1-string</h3><ul>
<li>string<ul>
<li>string是redis最基本的类型</li>
<li>最大能存储512MB数据</li>
<li>string类型是二进制安全的，即可以为任何数据，比如数字、图片、序列化对象等</li>
</ul>
</li>
<li>命令<ul>
<li>设置<ul>
<li>设置键值 <code>set key value</code></li>
<li>设置键值及过期时间，以秒为单位 <code>SETEX key seconds value</code></li>
<li>设置多个键值 <code>MSET key value [key value ...]</code></li>
</ul>
</li>
<li>获取<ul>
<li>根据键获取值，如果不存在此键则返回nil <code>GET key</code></li>
<li>根据多个键获取多个值 <code>MGET key [key ...]</code></li>
</ul>
</li>
<li>运算<ul>
<li>要求：值是数字</li>
<li>将key对应的value加1 <code>INCR key</code></li>
<li>将key对应的value加整数 <code>INCRBY key increment</code></li>
<li>将key对应的value减1 <code>DECR key</code></li>
<li>将key对应的value减整数 <code>DECRBY key decrement</code></li>
</ul>
</li>
<li></li>
</ul>
</li>
<li>其它<ul>
<li>追加值 <code>APPEND key value</code></li>
<li>获取值长度 <code>STRLEN key</code></li>
</ul>
</li>
</ul>
<h3 id="3-2-键命令"><a href="#3-2-键命令" class="headerlink" title="3.2-键命令"></a>3.2-键命令</h3><ul>
<li>查找键，参数支持正则 <code>KEYS pattern</code></li>
<li>判断键是否存在，如果存在返回1，不存在返回0 <code>EXISTS key [key ...]</code></li>
<li>查看键对应的value的类型 <code>TYPE key</code></li>
<li>删除键及对应的值 <code>DEL key [key ...]</code></li>
<li>设置过期时间，以秒为单位</li>
<li>创建时没有设置过期时间则一直存在，直到使用使用DEL移除 <code>EXPIRE key seconds</code></li>
<li>查看有效时间，以秒为单位 <code>TTL key</code></li>
</ul>
<h3 id="3-3-hash"><a href="#3-3-hash" class="headerlink" title="3.3-hash"></a>3.3-hash</h3><ul>
<li>hash用于存储对象，对象的格式为键值对</li>
<li>设置<ul>
<li>设置单个属性 <code>HSET key field value</code></li>
<li>设置多个属性 <code>HMSET key field value [field value ...]</code></li>
</ul>
</li>
<li>获取<ul>
<li>获取一个属性的值 <code>HGET key field</code></li>
<li>获取多个属性的值 <code>HMGET key field [field ...]</code></li>
<li>获取所有属性和值 <code>HGETALL key</code></li>
<li>获取所有的属性 <code>HKEYS key</code></li>
<li>返回包含属性的个数 <code>HLEN key</code></li>
<li>获取所有值 <code>HVALS key</code></li>
</ul>
</li>
<li>其它<ul>
<li>判断属性是否存在 <code>HEXISTS key field</code></li>
<li>删除属性及值 <code>HDEL key field [field ...]</code></li>
<li>返回值的字符串长度 <code>HSTRLEN key field</code></li>
</ul>
</li>
</ul>
<h3 id="3-4-list"><a href="#3-4-list" class="headerlink" title="3.4-list"></a>3.4-list</h3><ul>
<li><p>list</p>
<ul>
<li>列表的元素类型为string</li>
<li>按照插入顺序排序</li>
<li>在列表的头部或者尾部添加元素</li>
</ul>
</li>
<li><p>设置</p>
<ul>
<li><p>在头部插入数据 <code>LPUSH key value [value ...]</code></p>
</li>
<li><p>在尾部插入数据 <code>RPUSH key value [value ...]</code></p>
</li>
<li><p>在一个元素的前|后插入新元素 <code>LINSERT key BEFORE|AFTER pivot value</code></p>
<ul>
<li><p>设置指定索引的元素值</p>
</li>
<li><p>索引是基于0的下标</p>
</li>
<li><p>索引可以是负数，表示偏移量是从list尾部开始计数，如-1表示列表的最后一个元素</p>
<p><code>LSET key index value</code></p>
</li>
</ul>
</li>
</ul>
</li>
<li><p>获取</p>
<ul>
<li><p>移除并且返回 key 对应的 list 的第一个元素 <code>LPOP key</code></p>
</li>
<li><p>移除并返回存于 key 的 list 的最后一个元素 <code>RPOP key</code></p>
</li>
<li><p>返回存储在 key 的列表里指定范围内的元素</p>
</li>
<li><p>start 和 end 偏移量都是基于0的下标</p>
</li>
<li><p>偏移量也可以是负数，表示偏移量是从list尾部开始计数，如-1表示列表的最后一个元素</p>
<p><code>LRANGE key start stop</code></p>
</li>
</ul>
</li>
<li><p>其它</p>
<ul>
<li><p>裁剪列表，改为原集合的一个子集</p>
</li>
<li><p>start 和 end 偏移量都是基于0的下标</p>
</li>
<li><p>偏移量也可以是负数，表示偏移量是从list尾部开始计数，如-1表示列表的最后一个元素</p>
<p><code>LTRIM key start stop</code></p>
</li>
<li><p>返回存储在 key 里的list的长度 <code>LLEN key</code></p>
</li>
<li><p>返回列表里索引对应的元素 <code>LINDEX key index</code></p>
</li>
</ul>
</li>
</ul>
<h3 id="3-5-set"><a href="#3-5-set" class="headerlink" title="3.5-set"></a>3.5-set</h3><ul>
<li>set<ul>
<li>无序集合</li>
<li>元素为string类型</li>
<li>元素具有唯一性，不重复</li>
</ul>
</li>
<li>设置<ul>
<li>添加元素 <code>SADD key member [member ...]</code></li>
</ul>
</li>
<li>获取<ul>
<li>返回key集合所有的元素 <code>SMEMBERS key</code></li>
<li>返回集合元素个数 <code>SCARD key</code></li>
</ul>
</li>
<li>其它<ul>
<li>求多个集合的交集 <code>SINTER key [key ...]</code></li>
<li>求某集合与其它集合的差集 <code>SDIFF key [key ...]</code></li>
<li>求多个集合的合集 <code>SUNION key [key ...]</code></li>
<li>判断元素是否在集合中 <code>SISMEMBER key member</code></li>
</ul>
</li>
</ul>
<h3 id="3-6-zset"><a href="#3-6-zset" class="headerlink" title="3.6-zset"></a>3.6-zset</h3><ul>
<li>zset<ul>
<li>sorted set，有序集合</li>
<li>元素为string类型</li>
<li>元素具有唯一性，不重复</li>
<li>每个元素都会关联一个double类型的score，表示权重，通过权重将元素从小到大排序</li>
<li>元素的score可以相同</li>
</ul>
</li>
<li>设置<ul>
<li>添加 <code>ZADD key score member [score member ...]</code></li>
<li>获取<ul>
<li>返回指定范围内的元素 <code>ZRANGE key start stop</code></li>
<li>返回元素个数 <code>ZCARD key</code></li>
<li>返回有序集key中，score值在min和max之间的成员 <code>ZCOUNT key min max</code></li>
<li>返回有序集key中，成员member的score值 <code>ZSCORE key member</code></li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="04-高级"><a href="#04-高级" class="headerlink" title="04-高级"></a>04-高级</h2><h3 id="4-1-发布订阅"><a href="#4-1-发布订阅" class="headerlink" title="4.1-发布订阅"></a>4.1-发布订阅</h3><ul>
<li>发布订阅<ul>
<li>发布者不是计划发送消息给特定的接收者（订阅者），而是发布的消息分到不同的频道，不需要知道什么样的订阅者订阅</li>
<li>订阅者对一个或多个频道感兴趣，只需接收感兴趣的消息，不需要知道什么样的发布者发布的</li>
<li>发布者和订阅者的解耦合可以带来更大的扩展性和更加动态的网络拓扑</li>
<li>客户端发到频道的消息，将会被推送到所有订阅此频道的客户端</li>
<li>客户端不需要主动去获取消息，只需要订阅频道，这个频道的内容就会被推送过来</li>
</ul>
</li>
<li>消息的格式<ul>
<li>推送消息的格式包含三部分</li>
<li>part1:消息类型，包含三种类型<ul>
<li>subscribe，表示订阅成功</li>
<li>unsubscribe，表示取消订阅成功</li>
<li>message，表示其它终端发布消息</li>
</ul>
</li>
<li>如果第一部分的值为subscribe，则第二部分是频道，第三部分是现在订阅的频道的数量</li>
<li>如果第一部分的值为unsubscribe，则第二部分是频道，第三部分是现在订阅的频道的数量，如果为0则表示当前没有订阅任何频道，当在Pub/Sub以外状态，客户端可以发出任何redis命令</li>
<li>如果第一部分的值为message，则第二部分是来源频道的名称，第三部分是消息的内容</li>
</ul>
</li>
<li>命令<ul>
<li>订阅 <code>SUBSCRIBE 频道名称 [频道名称 ...]</code></li>
<li>取消订阅 如果不写参数，表示取消所有订阅 <code>UNSUBSCRIBE 频道名称 [频道名称 ...]</code></li>
<li>发布 <code>PUBLISH 频道 消息</code></li>
</ul>
</li>
</ul>
<h3 id="4-2-主从配置"><a href="#4-2-主从配置" class="headerlink" title="4.2-主从配置"></a>4.2-主从配置</h3><ul>
<li><p>一个master可以拥有多个slave，一个slave又可以拥有多个slave，如此下去，形成了强大的多级服务器集群架构</p>
</li>
<li><p>比如，将ip为192.168.1.10的机器作为主服务器，将ip为192.168.1.11的机器作为从服务器</p>
</li>
<li><p>设置主服务器的配置</p>
<p><code>bind 192.168.1.10</code></p>
</li>
<li><p>设置从服务器的配置 注意：在slaveof后面写主机ip，再写端口，而且端口必须写</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">bind 192.168.1.11</span><br><span class="line">slaveof 192.168.1.10 6379</span><br></pre></td></tr></table></figure>
</li>
<li><p>在master和slave分别执行info命令，查看输出信息</p>
</li>
<li><p>在master上写数据 <code>set hello world</code></p>
</li>
<li><p>在slave上读数据 <code>get hello</code></p>
</li>
</ul>
<h2 id="05-与Python交互"><a href="#05-与Python交互" class="headerlink" title="05-与Python交互"></a>05-与Python交互</h2><ul>
<li><p>安装包</p>
<ul>
<li><p>到<a href="http://redis.cn/clients.html" target="_blank" rel="noopener">中文官网</a>查找客户端代码</p>
</li>
<li><p>联网安装</p>
<p><code>sudo pip install redis</code></p>
</li>
<li><p>使用源码安装</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">unzip redis-py-master.zip</span><br><span class="line">cd redis-py-master</span><br><span class="line">sudo python setup.py install</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>交互代码</p>
<ul>
<li><p>引入模块 <code>import redis</code></p>
</li>
<li><p>连接</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">try:</span><br><span class="line">    r=redis.StrictRedis(host=&apos;localhost&apos;,port=6379)</span><br><span class="line">except Exception,e:</span><br><span class="line">    print e.message</span><br></pre></td></tr></table></figure>
</li>
<li><p>方式一：根据数据类型的不同，调用相应的方法，完成读写 更多方法同前面学的命令</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">r.set(&apos;name&apos;,&apos;hello&apos;)</span><br><span class="line">r.get(&apos;name&apos;)</span><br></pre></td></tr></table></figure>
</li>
<li><p>方式二：pipline 缓冲多条命令，然后一次性执行，减少服务器-客户端之间TCP数据库包，从而提高效率</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">pipe = r.pipeline()</span><br><span class="line">pipe.set(&apos;name&apos;, &apos;world&apos;)</span><br><span class="line">pipe.get(&apos;name&apos;)</span><br><span class="line">pipe.execute()</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>封装</p>
<ul>
<li><p>连接redis服务器部分是一致的</p>
</li>
<li><p>这里将string类型的读写进行封装</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">import redis</span><br><span class="line">class RedisHelper():</span><br><span class="line">    def __init__(self,host=&apos;localhost&apos;,port=6379):</span><br><span class="line">        self.__redis = redis.StrictRedis(host, port)</span><br><span class="line">    def get(self,key):</span><br><span class="line">        if self.__redis.exists(key):</span><br><span class="line">            return self.__redis.get(key)</span><br><span class="line">        else:</span><br><span class="line">            return &quot;&quot;</span><br><span class="line">    def set(self,key,value):</span><br><span class="line">        self.__redis.set(key,value)</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
<h2 id="06-应用实例"><a href="#06-应用实例" class="headerlink" title="06-应用实例"></a>06-应用实例</h2><blockquote>
<p>示例：用户登录</p>
</blockquote>
<ul>
<li><p>业务过程如下：</p>
<ul>
<li><p>输入用户名、密码</p>
</li>
<li><p>密码加密</p>
</li>
<li><p>判断redis中是否记录了用户名，如果有则成功</p>
</li>
<li><p>如果redis中没有用户名，则到mysql中查询</p>
</li>
<li><p>从mysql中查询成功后，将用户名记录到redis中</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">#encoding=utf-8</span><br><span class="line">from t2 import RedisHelper</span><br><span class="line">from t3 import MysqlHelper</span><br><span class="line">import hashlib</span><br><span class="line"></span><br><span class="line">name=raw_input(&quot;请输入用户名：&quot;)</span><br><span class="line">pwd=raw_input(&quot;请输入密码：&quot;)</span><br><span class="line"></span><br><span class="line">sha1=hashlib.sha1()</span><br><span class="line">sha1.update(pwd)</span><br><span class="line">pwd1=sha1.hexdigest()</span><br><span class="line"></span><br><span class="line">try:</span><br><span class="line">    redis=RedisHelper()</span><br><span class="line">    if redis.get(&apos;uname&apos;)==name:</span><br><span class="line">        print &apos;ok&apos;</span><br><span class="line">    else:</span><br><span class="line">        mysql=MysqlHelper(&apos;localhost&apos;,3306,&apos;test1&apos;,&apos;root&apos;,&apos;mysql&apos;)</span><br><span class="line">        upwd=mysql.get_one(&apos;select upwd from userinfos where uname=%s&apos;,[name])</span><br><span class="line">        if upwd==None:</span><br><span class="line">            print &apos;用户名错误&apos;</span><br><span class="line">        elif upwd[0]==pwd1:</span><br><span class="line">            redis.set(&apos;uname&apos;, name)</span><br><span class="line">            print &apos;登录成功&apos;</span><br><span class="line">        else:</span><br><span class="line">            print &quot;密码错误&quot;</span><br><span class="line">except Exception,e:</span><br><span class="line">    print e.message</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
<h2 id="07-总结"><a href="#07-总结" class="headerlink" title="07-总结"></a>07-总结</h2><ul>
<li>安装与连接</li>
<li>操作string、hash、list、set、zset的命令</li>
<li>python模块redis提供的命令</li>
</ul>

      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/python/" rel="tag"># python</a>
          
            <a href="/tags/redis/" rel="tag"># redis</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2017/11/19/python-MongoDB/" rel="next" title="python-MongoDB">
                <i class="fa fa-chevron-left"></i> python-MongoDB
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2017/11/19/python-MySQL/" rel="prev" title="python-MySQL">
                python-MySQL <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image" src="/images/avatar.jpg" alt="Ry1ynn">
            
              <p class="site-author-name" itemprop="name">Ry1ynn</p>
              <p class="site-description motion-element" itemprop="description">我们的征途是星辰大海</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">131</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">20</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">59</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          

          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a href="https://github.com/Ry1ynn" target="_blank" title="GitHub">
                      
                        <i class="fa fa-fw fa-github"></i>GitHub</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="mailto:ry1ynn_pri@163.com" target="_blank" title="E-Mail">
                      
                        <i class="fa fa-fw fa-envelope"></i>E-Mail</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="https://weibo.com/u/" target="_blank" title="Weibo">
                      
                        <i class="fa fa-fw fa-weibo"></i>Weibo</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="/images/weixin.JPG" target="_blank" title="Wechat">
                      
                        <i class="fa fa-fw fa-weixin"></i>Wechat</a>
                  </span>
                
            </div>
          

          
          

          
          
            <div class="links-of-blogroll motion-element links-of-blogroll-inline">
              <div class="links-of-blogroll-title">
                <i class="fa  fa-fw fa-link"></i>
                Links
              </div>
              <ul class="links-of-blogroll-list">
                
                  <li class="links-of-blogroll-item">
                    <a href="https://www.t00ls.net/" title="T00ls" target="_blank">T00ls</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="https://www.freebuf.com/" title="FreeBuf" target="_blank">FreeBuf</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="https://www.sec-wiki.com/" title="SecWiki" target="_blank">SecWiki</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="https://www.seebug.org/" title="Seebug" target="_blank">Seebug</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="http://www.91ri.org/" title="91Ri" target="_blank">91Ri</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="https://www.pediy.com/" title="看雪" target="_blank">看雪</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="https://www.52pojie.cn/" title="吾爱破解" target="_blank">吾爱破解</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="https://www.anquanke.com/" title="安全客" target="_blank">安全客</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="https://www.ichunqiu.com/" title="i春秋" target="_blank">i春秋</a>
                  </li>
                
              </ul>
            </div>
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#Redis相关"><span class="nav-text">Redis相关</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#00-简介"><span class="nav-text">00-简介</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#01-安装"><span class="nav-text">01-安装</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#02-配置"><span class="nav-text">02-配置</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#03-数据操作"><span class="nav-text">03-数据操作</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#3-1-string"><span class="nav-text">3.1-string</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-2-键命令"><span class="nav-text">3.2-键命令</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-3-hash"><span class="nav-text">3.3-hash</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-4-list"><span class="nav-text">3.4-list</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-5-set"><span class="nav-text">3.5-set</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-6-zset"><span class="nav-text">3.6-zset</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#04-高级"><span class="nav-text">04-高级</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#4-1-发布订阅"><span class="nav-text">4.1-发布订阅</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-2-主从配置"><span class="nav-text">4.2-主从配置</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#05-与Python交互"><span class="nav-text">05-与Python交互</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#06-应用实例"><span class="nav-text">06-应用实例</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#07-总结"><span class="nav-text">07-总结</span></a></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; 2016 &mdash; <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Ry1ynn</span>

  
</div>









        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  










  



  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  

  
  
    <script id="ribbon" type="text/javascript" size="300" alpha="0.5" zindex="0" src="/lib/canvas-ribbon/canvas-ribbon.js"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
